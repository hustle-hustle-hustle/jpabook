# 6. 다양한 연관관계 매핑
* 다중성과 단방향,양방향을 고려한 연관관계를 알아보자
  
## 다대일 (N:1)
* N:1 관계에서 외래키는 항상 N쪽에있다. (객체 양방향 관계에서 주인은 항상 N쪽)
* JPA는 외래키를 관리할때 연관관계의 주인만 사용한다.
* 양방향 연관관계는 항상 서로를 참조 해야한다.

## 일대다 (1:N)
* 1:N 관계에서는 외래키가 항상 N쪽에 있다. 따라서 반대편 테이블의 외래키를 관리하게 된다.
* 일대다 단방향 관계를 매핑 할때는 @JoinColumn을 명시해야 한다. 그렇지 않으면 연결 테이블을 중간에 두고 관리하는 JoinTable 전략을 기본으로 사용해 매핑한다.
* 외래키가 다른 테이블에 있기 때문에, 연관관계 처리를 위한 UPDATE 문의 실행이 필요하다. -> 1:N 단방향 매핑보다는 보다는 N:1 양방향 매핑을 사용하자, 
* oneToMany는 연관관계의 주인이 될 수 없다. 

## 일대일(1:1)
* 주 테이블이나 대상 테이블 어느 곳이나 외래키를 가질 수 있다.
* 주 테이블에 외래키
    * 주 테이블에 외래키를 두고 대상 테이블 참조 한다.
    * 객체 참조 처럼 사용 가능.
* 대상 테이블에 외래키
    * 1:1 -> 1:N이 될때 변경하기가 쉽다.
    * 대상 테이블에 외래 키가 있는 단방향 관계는 JPA에서 지원하지 않는다.
* 프록시를 사용할 떄 외래키를 직접 관리 하지 않는 일대일 관계는 지연로딩으로 설정해도 즉시 로딩 된다.

## 다대다(N:N)
* 관계형 데이터베이스는 정규화된 테이블 2개로 표현 할 수없다. -> 객체는 컬렉션을 통해 표현 가능-> 연결 테이블을 통해 관리한다.
* 연결 엔티티를 사용 할 수도있음.
* 복합 기본키
    * 별도의 식별자 클래스가 필요함(p.228) -> 복잡..
* 식별관계
    * 부모테이블의 기본키를 받아서 자신의 기본키+외래키로 사용하는것
* 비식별 관계
    * 받아온 식별자는 외래키로만 사용하고 새로운 식별자를 추가한다.